TMUX_CONFIG_DIR=$HOME/.config/tmux

setenv -g  TMUX_CONFIG_DIR          "$TMUX_CONFIG_DIR"
# setenv -g  TMUX_THEME               "$TMUX_CONFIG_DIR/meta.min.tmuxtheme"

# source $TMUX_CONFIG_DIR/colors.tmux
source $TMUX_CONFIG_DIR/profile.tmux
source $TMUX_CONFIG_DIR/keybindings.tmux
source $TMUX_CONFIG_DIR/neovim-integration.tmux

# set-hook -g  window-linked   'source ${TMUX_THEME}'
# set-hook -g  session-created 'source ${TMUX_THEME}'
# set-hook -g  session-renamed 'source ${TMUX_THEME}'

# Let tmux know where TPM is installed
set -g @plugin 'tmux-plugins/tpm'

# Recommended default settings
set -g @plugin 'tmux-plugins/tmux-sensible'

# Optional plugins
set -g @plugin 'tmux-plugins/tmux-resurrect'
set -g @plugin 'tmux-plugins/tmux-continuum'
set -g @plugin 'christoomey/vim-tmux-navigator'

# Load our custom theme
source $TMUX_CONFIG_DIR/theme.tmux

# Ensure window names are preserved and displayed properly
set -g allow-rename on

# Nuclear option: Completely prevent ALL automatic renaming from any source
set-option -g status-interval 1
set-option -g automatic-rename off
set-option -g automatic-rename-format ""
set-option -g allow-rename off
set-option -wg automatic-rename off
set-option -wg allow-rename off

# Prevent applications (like neovim) from changing window titles
set-option -g set-titles off
set-option -g set-titles-string ""

# Session name removal hooks (theme already sets status-left to empty)
set-hook -g session-created 'set -g status-left ""'
set-hook -g client-attached 'set -g status-left ""'

# Bulletproof window naming system - names are sacred once set manually
set-hook -g after-new-window 'command-prompt -p "ó±‚¬ Window name: " "rename-window \"%%\"; set-window-option automatic-rename off; set-window-option allow-rename off; set-window-option set-titles off"'

# NEVER allow any automatic renaming once a window has been manually named
set-hook -g window-renamed 'set-window-option automatic-rename off; set-window-option allow-rename off; set-window-option set-titles off'

# Completely disable all forms of automatic renaming on any window event
set-hook -g after-select-window 'set-window-option automatic-rename off; set-window-option allow-rename off; set-window-option set-titles off'
set-hook -g after-select-pane 'set-window-option automatic-rename off; set-window-option allow-rename off; set-window-option set-titles off'
set-hook -g pane-focus-in 'set-window-option automatic-rename off; set-window-option allow-rename off; set-window-option set-titles off'

# Nuclear protection against applications changing window titles
set-hook -g pane-exited 'set-window-option automatic-rename off; set-window-option allow-rename off; set-window-option set-titles off'
set-hook -g after-new-session 'set-window-option automatic-rename off; set-window-option allow-rename off; set-window-option set-titles off'

# Clipboard integration
set -g set-clipboard on

# Enable mouse support
set -g mouse on

unbind C-b
set -g prefix C-s
bind C-s send-prefix

# TPM bindings
bind-key I run '/usr/share/tmux-plugin-manager/tpm/bin/install_plugins'
bind-key U run '/usr/share/tmux-plugin-manager/tpm/bin/update_plugins'
bind-key r source-file ~/.config/tmux/tmux.conf \; display-message "Config reloaded!"

# Initialize TMUX plugin manager (keep this line at the very bottom of tmux.conf)
run '/usr/share/tmux-plugin-manager/tpm'
